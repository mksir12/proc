<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>Video Tools</title>
  <style>
    body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", Roboto, sans-serif; background: #f9f9fb; color: #111; }
    header { text-align: center; padding: 16px; font-size: 18px; font-weight: 600; background: #fff; border-bottom: 1px solid #ddd; position: sticky; top: 0; z-index: 99; }
    .container { padding: 16px; }
    textarea { width: 100%; min-height: 180px; padding: 12px; border-radius: 12px; border: 1px solid #ccc; font-size: 14px; font-family: monospace; outline: none; background: #fff; resize: vertical; }
    button.action { width: 100%; padding: 14px; margin-top: 14px; border-radius: 12px; border: none; background: #007aff; color: #fff; font-size: 16px; font-weight: 500; cursor: pointer; transition: 0.2s; }
    button.action:hover { background: #005ecb; }
    nav { display: flex; justify-content: space-around; position: fixed; bottom: 0; left: 0; right: 0; background: #fff; border-top: 1px solid #ddd; }
    nav button { flex: 1; background: none; border: none; padding: 8px; font-size: 12px; color: #666; display: flex; flex-direction: column; align-items: center; cursor: pointer; }
    nav button.active { color: #007aff; }
    nav button svg { width: 22px; height: 22px; margin-bottom: 4px; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <header>Video Tools</header>

  <!-- CHECK LINKS TAB -->
  <div id="checkTab" class="container">
    <h3>Check Video Links</h3>
    <textarea id="checkInput" placeholder="Paste links here..."></textarea>
    <div><label><input type="checkbox" id="asJson" /> Return JSON</label></div>
    <button class="action" id="checkBtn">Check Links</button>
  </div>

  <!-- DUPLICATE CLEANER TAB -->
  <div id="dupTab" class="container hidden">
    <h3>Remove Duplicates</h3>
    <textarea id="dupInput" placeholder="Paste links here..."></textarea>
    <button class="action" id="dupBtn">Clean Duplicates</button>
  </div>

  <!-- iOS Bottom Nav -->
  <nav>
    <button id="navCheck" class="active">
      <!-- Magnifying Glass Icon -->
      <svg fill="currentColor" viewBox="0 0 24 24"><path d="M10 2a8 8 0 105.29 14.29l4.71 4.7 1.42-1.41-4.7-4.71A8 8 0 0010 2zm0 2a6 6 0 110 12A6 6 0 0110 4z"/></svg>
      Check
    </button>
    <button id="navDup">
      <!-- Clone/Duplicate Icon -->
      <svg fill="currentColor" viewBox="0 0 24 24"><path d="M7 7V3h14v14h-4v4H3V7h4zm2 2H5v12h12v-4h-8V9z"/></svg>
      Duplicate
    </button>
  </nav>

  <script>
    // Parse pasted links
    function parseUrls(raw) {
      return raw.split(/[\n,]+/g)
        .map(s => s.trim())
        .map(s => s.replace(/^"+|"+$/g, ''))
        .map(s => s.replace(/,+$/g, ''))
        .filter(s => s && /^https?:\/\//.test(s));
    }

    // Tab Switching
    const checkTab = document.getElementById('checkTab');
    const dupTab = document.getElementById('dupTab');
    document.getElementById('navCheck').addEventListener('click', () => {
      checkTab.classList.remove('hidden'); dupTab.classList.add('hidden');
      document.getElementById('navCheck').classList.add('active');
      document.getElementById('navDup').classList.remove('active');
    });
    document.getElementById('navDup').addEventListener('click', () => {
      dupTab.classList.remove('hidden'); checkTab.classList.add('hidden');
      document.getElementById('navDup').classList.add('active');
      document.getElementById('navCheck').classList.remove('active');
    });

    // Check Links → open plain/text result
    document.getElementById('checkBtn').addEventListener('click', () => {
      const urls = parseUrls(document.getElementById('checkInput').value || "");
      if (!urls.length) { alert("Paste at least one valid URL"); return; }
      const asJson = document.getElementById('asJson').checked;
      const urlParam = urls.map(encodeURIComponent).join(',');
      let target = `/api/check?url=${urlParam}`;
      if (asJson) target += "&format=json";
      window.open(target, "_blank");
    });

    // Duplicate Cleaner → open plain/text result
    document.getElementById('dupBtn').addEventListener('click', () => {
      const urls = parseUrls(document.getElementById('dupInput').value || "");
      if (!urls.length) { alert("Paste at least one valid URL"); return; }
      const urlParam = urls.map(encodeURIComponent).join(',');
      let target = `/api/duplicate?url=${urlParam}`;
      window.open(target, "_blank");
    });
  </script>
</body>
</html>
